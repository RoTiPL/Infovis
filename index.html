<!DOCTYPE html>
<html>
<head>
    <title>Students Performance Vis</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>
    <script src="components/barchart.js"></script>
    <script src="components/scatterplot.js"></script>

    <style>
        .container {
            min-width: 800px;
        }
    </style>
</head>

<body style="background-color: #f1f1f1;">
    <header class="p-3 bg-dark text-white" style="min-width: 800px;">
        <div class="container">
            <a class="align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none" onClick="window.location.reload()">
                <span class="fs-4">Students Performance of Personal Environment</span>
            </a>
        </div>
    </header>
    

    <main class="container bg-white">
        <div class="d-flex">
            <div class="border border-dark border-2 p-2 mt-2 mb-2 border-opacity-50 rounded-3 w-auto" style="margin: 0 auto">
                <div class="d-flex">
                    <div class="text-end ps-2 pe-3"><strong>Category1:</strong></div>
                    <div class="">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c1-encoding" value="gender" id="c1-ge"
                                checked>
                            <label class="form-check-label" for="c1-ge">gender</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c1-encoding" value="race/ethnicity" id="c1-re">
                            <label class="form-check-label" for="c1-re">race/ethnicity</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c1-encoding" value="parental level of education" id="c1-pl">
                            <label class="form-check-label" for="c1-pl">parental level of education</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c1-encoding" value="lunch" id="c1-lu">
                            <label class="form-check-label" for="c1-lu">lunch</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c1-encoding" value="test preparation course" id="c1-pc">
                            <label class="form-check-label" for="c1-pc">test preparation course</label>
                        </div>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="text-end ps-2 pe-3"><strong>Category2:</strong></div>
                    <div class="">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c2-encoding" value="gender" id="c2-ge">
                            <label class="form-check-label" for="c2-ge">gender</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c2-encoding" value="race/ethnicity" id="c2-re"
                            checked>
                            <label class="form-check-label" for="c2-re">race/ethnicity</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c2-encoding" value="parental level of education" id="c2-pl">
                            <label class="form-check-label" for="c2-pl">parental level of education</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c2-encoding" value="lunch" id="c2-lu">
                            <label class="form-check-label" for="c2-lu">lunch</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="c2-encoding" value="test preparation course" id="c2-pc">
                            <label class="form-check-label" for="c2-pc">test preparation course</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="barchart" class="mb-5">

        </div>

        <div class="container text-center">
            <svg width="400" height="400" id="scatterplot">
            </svg>
        </div>


    </main>

    <script>
        let data, scatterplot
        function updateBarchart() {
            let x0Var = d3.select("input[type=radio][name=c1-encoding]:checked").property("value");
            let x1Var = d3.select("input[type=radio][name=c2-encoding]:checked").property("value");
            //initialize('#barchart')
            //update(x0Var, x1Var)
            barchart('#barchart', data, x0Var, x1Var)
        }


        function updateScatterplot() {
            let xVar = "writing score";
            let yVar = "reading score";
            let useColor = true;

            // TODO: update the scatterplot by calling scatterplot.update 
            scatterplot.update(xVar, yVar, "race/ethnicity", useColor);
        }


        d3.csv("https://raw.githubusercontent.com/RoTiPL/Infovis/master/StudentsPerformance.csv")
            .then(csvData => {
                csvData.forEach(d => {
                    d["math score"] = +d["math score"];
                    d["reading score"] = +d["reading score"];
                    d["writing score"] = +d["writing score"];                    
                });

                data = csvData;
                //initialize('#barchart')
                updateBarchart()
                d3.selectAll("input[type=radio][name=c1-encoding]").on("change", updateBarchart);
                d3.selectAll("input[type=radio][name=c2-encoding]").on("change", updateBarchart);


                scatterplot = new Scatterplot("#scatterplot", data);
                scatterplot.initialize();

                updateScatterplot();
            })
    </script>


</body>
</html>